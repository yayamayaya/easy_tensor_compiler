<br />
<div align="center">

<h1 align="center">Easy tensor compiler</h1>
</div>


<!-- ABOUT THE PROJECT -->
## О проекте

Здесь представлен проект простого тензорного компилятора, способного производить вычисления с тензорами и создавать простые нейросети. На вход компилятору подаётся, на выходе также получается тензор. Компилятор умеет производить вычисления таких операций, как: скалярное сложение, умножение, матричное умножение, конволюция матриц, функции relu и softmax. 

<!-- GETTING STARTED -->
## Начало работы

Склонируйте репозиторий в свою среду vscode:
   ```sh
   git clone github.com/yayamayaya/easy_tensor_compiler.git
   ```

Используйте тензор как библиотеку, для этого:
```C++
#include "tensor_compiler.hpp"
```

При сборке проекта используйте CMake и добавьте к цели библиотеку `tensor_compiler`, а также директорию `./src/` в качестве субдиректории.

Вы можете задать тензор в NCHW формате следующим образом:
```C++
//Тензор с данными
tensor t({1, 2, 3, 4, 5, 6, 7, 8});
//ОБЯЗАТЕЛЬНО! Задаём размер тензора в формате NCHW
t.set_tensor_size(1, 1, 2, 4);
```

Затем мы можем задать какую-то операцию или вход, используя `std::shared_ptr`
```C++
//Задаём input
std::shared_ptr<input_data> input = std::make_shared<input_data>(t);

//Задаём тензор weight
tensor weight({4, 3, 2, 1, 5, 6, 7, 8});
weight.set_tensor_size(1, 1, 2, 4);

//Создаём операцию скалярного сложения
std::shared_ptr<scalar_add_op> op = std::make_shared<scalar_add_op>(input, weight);
```

Вы можете выполнить простую операцию, используя `op->evaluate()`

Также, можно создать цепочку операций, используя `neural_network`
```C++
//Иницаилизируем класс
neural_network my_network;

//Добавляем операции в ПОРЯДКЕ ИХ ВЫПОЛНЕНИЯ
my_network.add_op(op);

//Запускаем нейросеть
my_network.infer()
```

Прошу обратить внимание, что операция, возвращающая выход нашей нейросети должна находиться в конце.

С проектом также идут некоторые основные тесты, чтобы запустить их, нужно:

* Иметь библиотеки Google Test

* Включить опцию `COMPILE_TESTS` в главном cmake

* Запустить скрипт `install.sh`, который соберет проект.

* Запустить скрипт `run_tests.sh`, который запустит тесты.